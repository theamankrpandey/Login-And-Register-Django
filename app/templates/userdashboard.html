{% load static %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<!-- <link rel="stylesheet" href="{% static 'css/userdashboard.css' %}"> -->

<!DOCTYPE html>
<html>

<head>
    <title>User Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/userdashboard.css' %}">


</head>

<body>

    <div class="container">

        <div class="sidebar">
            <h2>User Panel</h2>

            <a href="#">üë§ My Profile</a>
            <a href="#">üìù My_query</a>
            <a href="#">üìä query_status</a>
            <a href="#">üìä All_query</a>

            <div class="logout-box">
                <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
            </div>
        </div>
        <div>
            <h1>Welcome, {{ data.Name }}</h1>
        </div>
        <hr>
        {% if profile %}
        <div class="main"
            style="min-height:100vh; display:flex; align-items:center; justify-content:center; background:#f4f7fb; font-family:Arial, sans-serif;">

            <div class="card"
                style="width:600px; background:#fff; border-radius:18px; padding:50px 50px 50px 150px; position:relative; box-shadow:0 20px 40px rgba(0,0,0,0.15); transition:transform 0.35s ease, box-shadow 0.35s ease;"
                onmouseover="this.style.transform='translateY(-10px)'; this.style.boxShadow='0 30px 60px rgba(0,0,0,0.2)';"
                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 20px 40px rgba(0,0,0,0.15)';">

                {% if data.profile %}
                <img src="{{ data.profile.url }}" alt="{{ data.name }} Profile"
                    style="position:absolute; top:30px; left:30px; width:90px; height:90px; border-radius:50%; object-fit:cover; animation: float 3s ease-in-out infinite; cursor:pointer;"
                    onmouseover="this.style.transform='scale(1.1)';" onmouseout="this.style.transform='scale(1)';">
                {% else %}
                <div style="position:absolute; top:30px; left:30px; width:90px; height:90px; border-radius:50%; background:linear-gradient(135deg,#4facfe,#00f2fe); color:#fff; font-size:30px; font-weight:bold; display:flex; align-items:center; justify-content:center; animation: float 3s ease-in-out infinite; cursor:pointer;"
                    onmouseover="this.style.transform='scale(1.1)';" onmouseout="this.style.transform='scale(1)';">
                    {{ data.name|default:"U"|slice:":1"|upper }}
                </div>
                {% endif %}

                <div class="info" style="margin-top:20px;">
                    <p style="margin:16px 0; font-size:17px; color:#444; line-height:1.6;"><strong
                            style="color:#222; font-weight:600; margin-right:6px;">Email:</strong> {{ data.email }}</p>
                    <p style="margin:16px 0; font-size:17px; color:#444; line-height:1.6;"><strong
                            style="color:#222; font-weight:600; margin-right:6px;">Contact:</strong> {{ data.contact }}
                    </p>
                    <p style="margin:16px 0; font-size:17px; color:#444; line-height:1.6;"><strong
                            style="color:#222; font-weight:600; margin-right:6px;">Password:</strong> ******</p>
                    <p style="margin:16px 0; font-size:17px; color:#444; line-height:1.6;"><strong
                            style="color:#222; font-weight:600; margin-right:6px;">Department:</strong>
                        {{data.department}}</p>
                </div>

            </div>
        </div>

        <!-- Floating Animation -->
        <style>
            @keyframes float {
                0% {
                    transform: translateY(0);
                }

                50% {
                    transform: translateY(-6px);
                }

                100% {
                    transform: translateY(0);
                }
            }
        </style>
        {% endif %}


        {% if query %}
        <div class="main"
            style="min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; background:#f4f7fb; font-family:Arial, sans-serif; padding-top:50px;">

            <h1 style="font-size:36px; color:#333; margin-bottom:30px; text-align:center;">Query Form</h1>

            <div class="card"
                style="width:600px; background:#fff; border-radius:18px; padding:40px; box-shadow:0 20px 50px rgba(0,0,0,0.1); display:flex; flex-direction:column; gap:20px;">
                <form method="post" action="{% url 'query_data' %}">
                    {% csrf_token %}
                    <!-- Name Field -->
                    <div class="field" style="display:flex; flex-direction:column;">
                        <label style="margin-bottom:6px; font-weight:600; color:#222;">Name</label>
                        <input type="text" name="name" value="{{ data.name }}" readonly
                            style="padding:10px 12px; border-radius:6px; border:1px solid #ccc; font-size:16px;">
                    </div>

                    <!-- Email Field -->
                    <div class="field" style="display:flex; flex-direction:column;">
                        <label style="margin-bottom:6px; font-weight:600; color:#222;">Email</label>
                        <input type="email" name='email' value="{{ data.email }}" readonly
                            style="padding:10px 12px; border-radius:6px; border:1px solid #ccc; font-size:16px;">
                    </div>

                    <!-- Contact Field -->
                    <!-- <div class="field" style="display:flex; flex-direction:column;">
                        <label style="margin-bottom:6px; font-weight:600; color:#222;">Contact</label>
                        <input type="number" name='contact' value="{{ data.contact }}" readonly
                            style="padding:10px 12px; border-radius:6px; border:1px solid #ccc; font-size:16px;">
                    </div> <br> -->


                    <select name="subject"> Subject
                        <option value="option">--Select Subject--</option>
                        <option value="attandance">Attandance</option>
                        <option value="salary">Salary</option>
                        <option value="profile">Profile</option>
                        <option value="leave">Leave</option>
                    </select> <br> <br>

                    <!-- Query Field -->
                    <div class="field" style="display:flex; flex-direction:column;">
                        <label style="margin-bottom:6px; font-weight:600; color:#222;">Query</label>
                        <textarea placeholder="Query here..." name="query"
                            style="padding:10px 12px; border-radius:6px; border:1px solid #ccc; font-size:16px; resize:none; height:120px;"></textarea>
                    </div> <br>

                    <!-- Submit Button -->
                    <button class="btn"
                        style="padding:12px 20px; background:#4facfe; color:#fff; border:none; border-radius:8px; font-size:16px; font-weight:600; cursor:pointer; transition:0.3s;"
                        onmouseover="this.style.background='#00f2fe';" onmouseout="this.style.background='#4facfe';">
                        Submit Query
                    </button>
                    </from>
            </div>
        </div>
        {% endif %}


        {% if query_status %}
        <div
            style="min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; background:#f4f7fb; font-family:Arial, sans-serif; padding-top:50px;">

            <div
                style="width:700px; background:#fff; border-radius:18px; padding:40px; box-shadow:0 20px 50px rgba(0,0,0,0.1);">

                <!-- Heading -->
                <h3 style="font-size:28px; color:#333; margin-bottom:20px; text-align:center;">Query Status</h3>

                <!-- Table -->
                <table style="width:100%; border-collapse:collapse; text-align:left; font-size:16px;">
                    <thead>
                        <tr style="background:#4facfe; color:#fff;">
                            <th style="padding:12px; border-bottom:1px solid #ddd;">S.No</th>
                            <th style="padding:12px; border-bottom:1px solid #ddd;">Query</th>
                            <th style="padding:12px; border-bottom:1px solid #ddd;">Status</th>
                            <th style="padding:12px; border-bottom:1px solid #ddd;">Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for q in query_status %}
                        <tr style="background:#fff; transition:background 0.3s;">
                            <td style="padding:12px; border-bottom:1px solid #ddd;">{{ forloop.counter }}</td>
                            <td style="padding:12px; border-bottom:1px solid #ddd;">{{ q.query }}</td>
                            <td style="padding:12px; border-bottom:1px solid #ddd;">
                                {{q.status}}
                            </td>
                            <td style="padding:12px; border-bottom:1px solid #ddd;">{{ q.solution}}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" style="padding:12px; text-align:center;">No queries submitted</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>
        {% endif %}


        {% if All_query %}
        <div
            style="min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; background:#f4f7fb; font-family:Arial, sans-serif; padding-top:50px;">

            <!-- Search Bar -->
            <div style="width:700px; display:flex; justify-content:flex-end; margin-bottom:15px;">
                <input type="text" placeholder="Search..." name="search"
                    style="padding:10px 14px; border-radius:6px; border:1px solid #ccc; font-size:16px; width:200px;">
            </div>

            <!-- Table Card -->
            <div
                style="width:700px; background:#fff; border-radius:18px; padding:30px 40px; box-shadow:0 20px 50px rgba(0,0,0,0.1);">

                <table style="width:100%; border-collapse:collapse; font-size:16px;">
                    <thead>
                        <tr style="background:#4facfe; color:#fff;">
                            <th style="padding:12px 15px; border-bottom:1px solid #ddd;">S.No</th>
                            <th style="padding:12px 15px; border-bottom:1px solid #ddd;">Query</th>
                            <th style="padding:12px 15px; border-bottom:1px solid #ddd;">Edit</th>
                            <th style="padding:12px 15px; border-bottom:1px solid #ddd;">Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for q in All_query %}
                        <tr style="background:#fff; transition:background 0.3s;">
                            <td style="padding:12px 15px; border-bottom:1px solid #ddd;">{{ forloop.counter }}</td>
                            <td style="padding:12px 15px; border-bottom:1px solid #ddd;">{{ q.query }}</td>
                            <td style="padding:12px 15px; text-align:center; border-bottom:1px solid #ddd;">
                                <button
                                    style="padding:6px 12px; background:#ffa500; color:#fff; border:none; border-radius:4px; cursor:pointer;"
                                    onmouseover="this.style.background='#ff8c00';"
                                    onmouseout="this.style.background='#ffa500';"><a
                                        href="{% url 'edit' pk=q.id %}">Edit</a></button>
                            </td>
                            <td style="padding:12px 15px; text-align:center; border-bottom:1px solid #ddd;">
                                <button
                                    style="padding:6px 12px; background:#ff4d4f; color:#fff; border:none; border-radius:4px; cursor:pointer;"
                                    onmouseover="this.style.background='#d9363e';"
                                    onmouseout="this.style.background='#ff4d4f';"><a href=""></a>Delete</a></button>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" style="padding:12px; text-align:center;">No queries submitted</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>
        {% endif %}



        {% if e_query %}
        <div class="main"
            style="min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; background:#f4f7fb; font-family:Arial, sans-serif; padding-top:50px;">

            <h1 style="font-size:36px; color:#333; margin-bottom:30px; text-align:center;">
                Update your query
            </h1>

            <div class="card"
                style="width:600px; background:#fff; border-radius:18px; padding:40px; box-shadow:0 20px 50px rgba(0,0,0,0.1); display:flex; flex-direction:column; gap:20px;">

                <form method="post" action="{% url 'update' e_query.id %}">
                    {% csrf_token %}

                    <!-- Name -->
                    <div class="field">
                        <label>Name</label>
                        <input type="text" name="name" value="{{ e_query.name|default_if_none:'' }}"
                            class="form-control">
                    </div>

                    <!-- Email -->
                    <div class="field">
                        <label>Email</label>
                        <input type="email" name="email" value="{{ e_query.email|default_if_none:'' }}"
                            class="form-control">
                    </div>

                   

                    <!-- Subject -->
                    <div class="field">
                        <label>Subject</label>
                        <select name="subject" class="form-control">
                            <option value="">--Select Subject--</option>

                            <option value="attendance" {% if e_query.subject == "attendance" %}selected{% endif %}>
                                Attendance
                            </option>

                            <option value="salary" {% if e_query.subject == "salary" %}selected{% endif %}>
                                Salary
                            </option>

                            <option value="profile" {% if e_query.subject == "profile" %}selected{% endif %}>
                                Profile
                            </option>

                            <option value="leave" {% if e_query.subject == "leave" %}selected{% endif %}>
                                Leave
                            </option>
                        </select>
                    </div>

                    <!-- Query -->
                    <div class="field">
                        <label>Query</label>
                        <textarea name="query" class="form-control"
                            rows="4">{{ e_query.query|default_if_none:'' }}</textarea>
                    </div>

                    <!-- Button -->
                    <button type="submit"
                        style="padding:12px 20px; background:#4facfe; color:#fff; border:none; border-radius:8px; font-size:16px; font-weight:600; cursor:pointer;">
                        Update Query
                    </button>

                </form>
            </div>
        </div>
        {% endif %}

    </div>
</body>

</html>